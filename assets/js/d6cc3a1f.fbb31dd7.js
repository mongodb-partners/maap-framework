"use strict";(self.webpackChunkmaap_docs=self.webpackChunkmaap_docs||[]).push([[46],{2839:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>u,frontMatter:()=>s,metadata:()=>a,toc:()=>c});var r=t(4848),i=t(8453);const s={sidebar_position:4},o="Structured Query in MongoDB Atlas",a={id:"demo/structured-query",title:"Structured Query in MongoDB Atlas",description:"Introduction",source:"@site/docs/demo/structured-query.md",sourceDirName:"demo",slug:"/demo/structured-query",permalink:"/maap-framework/docs/demo/structured-query",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"Vector Search",permalink:"/maap-framework/docs/demo/vector-search"},next:{title:"Quick Starts",permalink:"/maap-framework/docs/category/quick-starts"}},l={},c=[{value:"Introduction",id:"introduction",level:2},{value:"Key Steps",id:"key-steps",level:2},{value:"What is an MQL Query Template?",id:"what-is-an-mql-query-template",level:2},{value:"What is a System Prompt?",id:"what-is-a-system-prompt",level:2},{value:"How Does This Module Work?",id:"how-does-this-module-work",level:2},{value:"Benefits:",id:"benefits",level:3},{value:"Example ART Query Behaviors:",id:"example-art-query-behaviors",level:2},{value:"Configuration File",id:"configuration-file",level:2},{value:"Sample Config File:",id:"sample-config-file",level:3},{value:"Running the Application",id:"running-the-application",level:2}];function d(e){const n={code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"structured-query-in-mongodb-atlas",children:"Structured Query in MongoDB Atlas"}),"\n",(0,r.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,r.jsx)(n.p,{children:"Unlock the power of MongoDB Atlas's LLM-powered Structured Query to create dynamic, intelligent data retrieval systems. This guide walks you through setting up and leveraging Structured Queries to enhance your data operations."}),"\n",(0,r.jsx)(n.h2,{id:"key-steps",children:"Key Steps"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Create an MQL Query Template"}),": Design a query with placeholders for dynamic variables."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Define Variables with Descriptions"}),": Explain each variable in your template for clarity."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Craft a System Prompt for the LLM"}),": Guide the language model to produce desired results."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"what-is-an-mql-query-template",children:"What is an MQL Query Template?"}),"\n",(0,r.jsxs)(n.p,{children:["An MQL (MongoDB Query Language) Query Template is a JSON structure containing placeholders for variables. These placeholders (",(0,r.jsx)(n.code,{children:"${variableName}"}),") are replaced with user-provided values at runtime, enabling flexible and dynamic queries."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'[ { "$match": { "$or": [ { "firstName": "${firstName}" }, { "lastName": "${lastName}" } ] } }, { "$project": { "_id": 0, "message": 1 } } ]\n'})}),"\n",(0,r.jsx)(n.h2,{id:"what-is-a-system-prompt",children:"What is a System Prompt?"}),"\n",(0,r.jsx)(n.p,{children:"A System Prompt guides the Language Learning Model (LLM) to generate responses that align with your desired output."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'You are a helpful, human-like chatbot. Use the provided context and chat history to answer queries fully. If you don\'t know the answer, simply state that you don\'t know. Avoid mentioning words like "context" or "training data" in your responses.\n'})}),"\n",(0,r.jsx)(n.h2,{id:"how-does-this-module-work",children:"How Does This Module Work?"}),"\n",(0,r.jsx)(n.p,{children:"The module combines your MQL query template and system prompt to generate a final query. It replaces placeholders with actual values provided by the user, executes the query on your MongoDB Atlas cluster, and returns results to augment your vector search and LLM responses."}),"\n",(0,r.jsx)(n.h3,{id:"benefits",children:"Benefits:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Advanced Retrieval Techniques (ART)"}),": Integrate complex retrieval methods like graph lookups, time series queries, geospatial queries, and full-text searches with vector search."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Enhanced Context"}),": Supplement vector search results with additional data for more informed responses."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Stateful Knowledge"}),": Equip the LLM with real-time data to generate accurate and relevant answers."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"example-art-query-behaviors",children:"Example ART Query Behaviors:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["MongoDB ",(0,r.jsx)(n.em,{children:"Find Query"})," + Vector Search"]}),"\n",(0,r.jsxs)(n.li,{children:["MongoDB ",(0,r.jsx)(n.em,{children:"GraphLookup"})," + Vector Search"]}),"\n",(0,r.jsxs)(n.li,{children:["MongoDB ",(0,r.jsx)(n.em,{children:"Time Series Query"})," + Vector Search"]}),"\n",(0,r.jsxs)(n.li,{children:["MongoDB ",(0,r.jsx)(n.em,{children:"Geospatial Query"})," + Vector Search"]}),"\n",(0,r.jsxs)(n.li,{children:["MongoDB ",(0,r.jsx)(n.em,{children:"Full Text Search"})," + Vector Search"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"configuration-file",children:"Configuration File"}),"\n",(0,r.jsx)(n.p,{children:"The configuration file outlines how your application operates. It includes settings for data ingestion, embedding, vector storage, LLMs, and aggregate operators."}),"\n",(0,r.jsx)(n.h3,{id:"sample-config-file",children:"Sample Config File:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"ingest:\n  - source: 'web'\n    source_path: 'https://your-content-source.com/docs/intro'\n    chunk_size: 1000\n    chunk_overlap: 100\n\nembedding:\n  class_name: Nomic-v1.5\n\nvector_store:\n  connectionString: '<your_mongodb_connection_string>'\n  dbName: '<your_database_name>'\n  collectionName: 'embedded_content'\n  embeddingKey: 'embedding'\n  textKey: 'text'\n  vectorSearchIndexName: 'vector_index'\n  numCandidates: 150\n  minScore: 0.6\n  limit: 5\n  similarityFunction: 'cosine'\n\nllms:\n  class_name: Fireworks\n  model_name: 'accounts/fireworks/models/llama-v3p1-405b-instruct'\n  temperature: 0.1\n\nsystemPromptPath: '<path_to_your_system_prompt_file>'\n\nstream_options:\n  stream: true\n\naggregate_operators:\n  - connectionString: '<your_mongodb_connection_string>'\n    dbName: 'test'\n    collectionName: 'test'\n    aggregatePipelineName: 'testing'\n    queryFilePath: '<path_to_your_mql_query_file>'\n    variables:\n      firstName: 'First name of the person, capitalize first letter'\n      lastName: 'Last name of the person, capitalize first letter'\n"})}),"\n",(0,r.jsx)(n.h2,{id:"running-the-application",children:"Running the Application"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Prepare Your Data"}),": Ensure your target MongoDB collection is populated with the necessary data."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Ingest Data for Vector Search"}),": Use the following command to ingest data into your vector search-powered collection:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"npm run ingest /path/to/your/config.yaml\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Start the Application"}),": Run the application with your configuration file:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"npm run start /path/to/your/config.yaml\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.p,{children:"By following this guide, you can effectively utilize MongoDB Atlas's Structured Query capabilities to build powerful, context-aware applications that meet your clients' needs."})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>a});var r=t(6540);const i={},s=r.createContext(i);function o(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);