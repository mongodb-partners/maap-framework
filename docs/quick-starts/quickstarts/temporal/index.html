<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-quick-starts/quickstarts/temporal" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Temporal | MAAP</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://maap-framework.github.io/maap-framework/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://maap-framework.github.io/maap-framework/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://maap-framework.github.io/maap-framework/docs/quick-starts/quickstarts/temporal"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Temporal | MAAP"><meta data-rh="true" name="description" content="The MongoDB - Temporal Quickstart is an integrated end-to-end AI application framework that combines MongoDB Atlas, Amazon Bedrock, and Temporal Workflow technology. The system provides a conversational AI interface with advanced memory capabilities, semantic caching, and robust document processing abilities."><meta data-rh="true" property="og:description" content="The MongoDB - Temporal Quickstart is an integrated end-to-end AI application framework that combines MongoDB Atlas, Amazon Bedrock, and Temporal Workflow technology. The system provides a conversational AI interface with advanced memory capabilities, semantic caching, and robust document processing abilities."><link data-rh="true" rel="icon" href="/maap-framework/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://maap-framework.github.io/maap-framework/docs/quick-starts/quickstarts/temporal"><link data-rh="true" rel="alternate" href="https://maap-framework.github.io/maap-framework/docs/quick-starts/quickstarts/temporal" hreflang="en"><link data-rh="true" rel="alternate" href="https://maap-framework.github.io/maap-framework/docs/quick-starts/quickstarts/temporal" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"ðŸš€ Quick Starts","item":"https://maap-framework.github.io/maap-framework/docs/category/-quick-starts"},{"@type":"ListItem","position":2,"name":"Temporal","item":"https://maap-framework.github.io/maap-framework/docs/quick-starts/quickstarts/temporal"}]}</script><link rel="stylesheet" href="/maap-framework/assets/css/styles.a82a49b6.css">
<script src="/maap-framework/assets/js/runtime~main.8680292f.js" defer="defer"></script>
<script src="/maap-framework/assets/js/main.93c54176.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/maap-framework/"><div class="navbar__logo"><img src="/maap-framework/img/logo.svg" alt="MAAP Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/maap-framework/img/logo.svg" alt="MAAP Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">MAAP</b></a><a class="navbar__item navbar__link" href="/maap-framework/docs/framework/intro">Frameworks</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/maap-framework/docs/category/-quick-starts">Quick starts</a><a class="navbar__item navbar__link" href="/maap-framework/docs/category/-blogs">Partner Blogs</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/mongodb-partners/maap-framework/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/maap-framework/docs/category/-quick-starts">ðŸš€ Quick Starts</a><button aria-label="Collapse sidebar category &#x27;ðŸš€ Quick Starts&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/maap-framework/docs/category/confluent">Confluent</a><button aria-label="Expand sidebar category &#x27;Confluent&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/maap-framework/docs/quick-starts/quickstarts/anthropic">Anthropic</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/maap-framework/docs/quick-starts/quickstarts/arcee">Arcee</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/maap-framework/docs/quick-starts/quickstarts/cohere">Cohere</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/maap-framework/docs/quick-starts/quickstarts/firework">Fireworks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/maap-framework/docs/quick-starts/quickstarts/ibm">IBM</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/maap-framework/docs/quick-starts/quickstarts/langchain">Langchain</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/maap-framework/docs/quick-starts/quickstarts/meta">Meta</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/maap-framework/docs/quick-starts/quickstarts/temporal">Temporal</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/maap-framework/docs/quick-starts/quickstarts/togetherai">TogtherAI</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/maap-framework/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/maap-framework/docs/category/-quick-starts"><span>ðŸš€ Quick Starts</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Temporal</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Temporal</h1></header>
<p>The MongoDB - Temporal Quickstart is an integrated end-to-end AI application framework that combines MongoDB Atlas, Amazon Bedrock, and Temporal Workflow technology. The system provides a conversational AI interface with advanced memory capabilities, semantic caching, and robust document processing abilities.</p>
<p><a href="https://github.com/mongodb-partners/maap-temporal-qs" target="_blank" rel="noopener noreferrer"><img decoding="async" loading="lazy" src="https://github-readme-stats.vercel.app/api/pin/?username=mongodb-partners&amp;repo=maap-temporal-qs" alt="ReadMe Card" class="img_ev3q"></a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="table-of-contents">Table of Contents<a href="#table-of-contents" class="hash-link" aria-label="Direct link to Table of Contents" title="Direct link to Table of Contents">â€‹</a></h2>
<ol>
<li><a href="#1-system-overview">System Overview</a></li>
<li><a href="#2-architecture">Architecture</a>
<ul>
<li><a href="#21-core-components">2.1 Core Components</a></li>
<li><a href="#22-integration-points">2.2 Integration Points</a></li>
</ul>
</li>
<li><a href="#3-services-in-detail">Services in Detail</a>
<ul>
<li><a href="#31-host-service">3.1 Host Service</a></li>
<li><a href="#32-ai-memory-service">3.2 AI Memory Service</a></li>
<li><a href="#33-semantic-cache-service">3.3 Semantic Cache Service</a></li>
<li><a href="#34-data-loader-service">3.4 Data Loader Service</a></li>
<li><a href="#35-event-logger-service">3.5 Event Logger Service</a></li>
</ul>
</li>
<li><a href="#4-workflows">Workflows</a>
<ul>
<li><a href="#41-image-processing-workflow">4.1 Image Processing Workflow</a></li>
<li><a href="#42-semantic-cache-workflow">4.2 Semantic Cache Workflow</a></li>
<li><a href="#43-memory-retrieval-workflow">4.3 Memory Retrieval Workflow</a></li>
<li><a href="#44-ai-generation-workflow">4.4 AI Generation Workflow</a></li>
<li><a href="#45-data-ingestion-workflow">4.5 Data Ingestion Workflow</a></li>
</ul>
</li>
<li><a href="#5-mcp-model-context-protocol">MCP (Model Context Protocol)</a></li>
<li><a href="#6-mongodb-integration">MongoDB Integration</a>
<ul>
<li><a href="#61-collections-and-indexes">6.1 Collections and Indexes</a></li>
<li><a href="#62-vector-search">6.2 Vector Search</a></li>
</ul>
</li>
<li><a href="#7-installation--deployment">Installation &amp; Deployment</a>
<ul>
<li><a href="#71-environment-setup">7.1 Environment Setup</a></li>
<li><a href="#72-configuration-files">7.2 Configuration Files</a></li>
<li><a href="#73-deployment-scripts">7.3 Deployment Scripts</a></li>
<li><a href="#prerequisites">Prerequisites</a></li>
<li><a href="#mongodb-atlas-programmatic-access">MongoDB Atlas Programmatic Access</a></li>
<li><a href="#minimum-system-requirements">Minimum System Requirements</a></li>
<li><a href="#one-click-deployment">One-Click Deployment</a></li>
<li><a href="#manual-deployment">Manual Deployment</a></li>
</ul>
</li>
<li><a href="#8-api-reference">API Reference</a></li>
<li><a href="#9-usage-flow">Usage Flow</a></li>
<li><a href="#10-error-handling-and-logging">Error Handling and Logging</a></li>
<li><a href="#11-security-considerations">Security Considerations</a>
<ul>
<li><a href="#network-and-firewall-configuration">Network and Firewall Configuration</a></li>
<li><a href="#authentication-and-authorization">Authentication and Authorization</a></li>
<li><a href="#data-encryption">Data Encryption</a></li>
<li><a href="#network-peering-and-private-endpoints">Network Peering and Private Endpoints</a></li>
<li><a href="#compliance-and-monitoring">Compliance and Monitoring</a></li>
</ul>
</li>
<li><a href="#12-monitoring--logging">Monitoring &amp; Logging</a></li>
<li><a href="#13-troubleshooting">Troubleshooting</a></li>
<li><a href="#14-scalability-considerations">Scalability Considerations</a></li>
<li><a href="#15-development-guide">Development Guide</a></li>
<li><a href="#16-maintenance--operations">Maintenance &amp; Operations</a></li>
<li><a href="#conclusion">Conclusion</a></li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-system-overview">1. System Overview<a href="#1-system-overview" class="hash-link" aria-label="Direct link to 1. System Overview" title="Direct link to 1. System Overview">â€‹</a></h2>
<p>The architecture features multiple microservices communicating through a Temporal workflow orchestration layer, which ensures reliability, fault tolerance, and scalability. The system leverages MongoDB Atlas for vector database capabilities, Amazon Bedrock for AI services (embeddings and LLMs), and Temporal for workflow orchestration.</p>
<p>Key features include:</p>
<ul>
<li>Vectorized document storage and retrieval using MongoDB Atlas</li>
<li>Hybrid search combining vector similarity and keyword matching</li>
<li>AI-powered conversation and memory management</li>
<li>Workflow orchestration using Temporal</li>
<li>Integration with AWS Bedrock for AI model inference</li>
<li>Semantic caching for improved response times</li>
<li>AI-augmented memory for contextual responses</li>
<li>Data loading and processing from various sources</li>
<li>Image processing capabilities</li>
<li>Event logging and monitoring</li>
<li>Scalable and maintainable microservices architecture</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-architecture">2. Architecture<a href="#2-architecture" class="hash-link" aria-label="Direct link to 2. Architecture" title="Direct link to 2. Architecture">â€‹</a></h2>
<p>The system architecture diagram for MongoDB - Temporal Quickstart:</p>
<p><img decoding="async" loading="lazy" alt="Temporal MongoDB Application Architecture" src="/maap-framework/assets/images/TemporalAWSArchitecture-09450b0df35b2fc9ee2ad9bbc7242033.png" width="1731" height="731" class="img_ev3q"></p>
<p>The diagram illustrates the MongoDB - Temporal system architecture with:</p>
<ol>
<li><strong>User Interface</strong>: The entry point for user interactions</li>
<li><strong>FastAPI/Gradio Application</strong>: The web application layer providing the UI and API endpoints</li>
<li><strong>Temporal Workflow Engine</strong>: Orchestrates workflows and activities</li>
<li><strong>MCP Clients Manager</strong>: Central manager for Model Context Protocol clients</li>
<li><strong>Service Components</strong>:<!-- -->
<ul>
<li>MongoDB Service: Handles database operations</li>
<li>Bedrock Service: Manages AI model interactions</li>
<li>AI Memory Service: Provides conversation history and memory functions</li>
<li>Semantic Cache Service: Caches AI responses for similar queries</li>
<li>Data Loader Service: Ingests documents and web content</li>
<li>Event Logger Service: Centralized logging</li>
<li>Image Processing: Handles image uploads and processing</li>
</ul>
</li>
<li><strong>External Systems</strong>:<!-- -->
<ul>
<li>MongoDB Atlas: Vector database for data storage</li>
<li>AWS Bedrock: AI models for embeddings and text generation</li>
</ul>
</li>
<li><strong>Logging Service</strong>: Central logging facility for application monitoring</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="21-core-components">2.1 Core Components<a href="#21-core-components" class="hash-link" aria-label="Direct link to 2.1 Core Components" title="Direct link to 2.1 Core Components">â€‹</a></h3>
<p>The system consists of the following microservices:</p>
<ol>
<li><strong>Host Service</strong>: The central coordinator that manages the UI and workflow orchestration (Port 7860)</li>
<li><strong>AI Memory Service</strong>: Provides conversation history and memory functions (Port 8182)</li>
<li><strong>Semantic Cache Service</strong>: Caches AI responses for similar queries (Port 8183)</li>
<li><strong>Data Loader Service</strong>: Ingests and processes documents and web content (Port 8184)</li>
<li><strong>Event Logger Service</strong>: Centralized logging service (Port 8181)</li>
<li><strong>Temporal Service</strong>: Workflow orchestration and execution (Port 7233 &amp; 8080)</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="22-integration-points">2.2 Integration Points<a href="#22-integration-points" class="hash-link" aria-label="Direct link to 2.2 Integration Points" title="Direct link to 2.2 Integration Points">â€‹</a></h3>
<ul>
<li><strong>MongoDB Atlas</strong>: Vector database for storing embeddings, documents, and conversational data (Ports 27015 to 27017 (TCP))</li>
<li><strong>Amazon Bedrock</strong>: Provides AI capabilities through Claude and Titan models (Port 443)</li>
<li><strong>Temporal</strong>: Workflow orchestration system for reliable workflow execution (Port 7233 &amp; 8080)</li>
<li><strong>Docker &amp; Containers</strong>: All services are containerized for deployment</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-services-in-detail">3. Services in Detail<a href="#3-services-in-detail" class="hash-link" aria-label="Direct link to 3. Services in Detail" title="Direct link to 3. Services in Detail">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="31-host-service">3.1 Host Service<a href="#31-host-service" class="hash-link" aria-label="Direct link to 3.1 Host Service" title="Direct link to 3.1 Host Service">â€‹</a></h3>
<p>The Host Service serves as the central coordinator and provides:</p>
<ul>
<li>User interface via Gradio</li>
<li>Temporal workflow client</li>
<li>MCP (Model Context Protocol) server for tool integration</li>
<li>Workflow definitions and activity implementations</li>
</ul>
<p><strong>Key Files:</strong></p>
<ul>
<li><code>host/ui_app.py</code>: Main UI application</li>
<li><code>host/temporal_client.py</code>: Temporal client interface</li>
<li><code>host/workflows.py</code>: Workflow definitions</li>
<li><code>host/activities.py</code>: Activity implementations</li>
<li><code>host/temporal_worker.py</code>: Temporal worker implementation</li>
<li><code>host/maap_mcp/</code>: MCP server implementation</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="32-ai-memory-service">3.2 AI Memory Service<a href="#32-ai-memory-service" class="hash-link" aria-label="Direct link to 3.2 AI Memory Service" title="Direct link to 3.2 AI Memory Service">â€‹</a></h3>
<p>The AI Memory Service manages conversation history and memory, featuring:</p>
<ul>
<li>Long-term memory capabilities for AI</li>
<li>Hierarchical memory with importance-based retrieval</li>
<li>Vector-based similarity search for relevant memories</li>
<li>Conversation summarization</li>
</ul>
<p><strong>Key Files:</strong></p>
<ul>
<li><code>ai-memory/main.py</code>: API endpoints</li>
<li><code>ai-memory/services/memory_service.py</code>: Memory management functions</li>
<li><code>ai-memory/services/conversation_service.py</code>: Conversation handling</li>
<li><code>ai-memory/services/bedrock_service.py</code>: AI model integration</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="33-semantic-cache-service">3.3 Semantic Cache Service<a href="#33-semantic-cache-service" class="hash-link" aria-label="Direct link to 3.3 Semantic Cache Service" title="Direct link to 3.3 Semantic Cache Service">â€‹</a></h3>
<p>The Semantic Cache Service provides:</p>
<ul>
<li>Vector-based caching of AI responses</li>
<li>Similarity-based retrieval of cached responses</li>
<li>TTL-based cache expiration</li>
<li>User-specific cache entries</li>
</ul>
<p><strong>Key Files:</strong></p>
<ul>
<li><code>semantic-cache/main.py</code>: API endpoints</li>
<li><code>semantic-cache/services/cache_service.py</code>: Cache operations</li>
<li><code>semantic-cache/services/bedrock_service.py</code>: Embedding generation</li>
<li><code>semantic-cache/database/mongodb.py</code>: MongoDB integration</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="34-data-loader-service">3.4 Data Loader Service<a href="#34-data-loader-service" class="hash-link" aria-label="Direct link to 3.4 Data Loader Service" title="Direct link to 3.4 Data Loader Service">â€‹</a></h3>
<p>The Data Loader Service provides document ingestion and processing:</p>
<ul>
<li>File upload and processing</li>
<li>Web page content extraction</li>
<li>Document chunking and embedding</li>
<li>MongoDB vector storage integration</li>
</ul>
<p><strong>Key Files:</strong></p>
<ul>
<li><code>data-loader/main.py</code>: API endpoints</li>
<li><code>data-loader/services/document_service.py</code>: Document processing</li>
<li><code>data-loader/services/embedding_service.py</code>: Vector embedding generation</li>
<li><code>data-loader/utils/file_utils.py</code>: File handling utilities</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="35-event-logger-service">3.5 Event Logger Service<a href="#35-event-logger-service" class="hash-link" aria-label="Direct link to 3.5 Event Logger Service" title="Direct link to 3.5 Event Logger Service">â€‹</a></h3>
<p>The Event Logger Service offers:</p>
<ul>
<li>Centralized logging for all services</li>
<li>Structured logging with context</li>
<li>MongoDB persistence of logs</li>
<li>Real-time and async log processing</li>
</ul>
<p><strong>Key Files:</strong></p>
<ul>
<li><code>event-logger/main.py</code>: API endpoints</li>
<li><code>event-logger/logger.py</code>: Logger implementation</li>
<li><code>event-logger/models/pydantic_models.py</code>: Log data models</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="4-workflows">4. Workflows<a href="#4-workflows" class="hash-link" aria-label="Direct link to 4. Workflows" title="Direct link to 4. Workflows">â€‹</a></h2>
<p>The system uses Temporal workflows to coordinate complex operations reliably. Key workflows include:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="41-image-processing-workflow">4.1 Image Processing Workflow<a href="#41-image-processing-workflow" class="hash-link" aria-label="Direct link to 4.1 Image Processing Workflow" title="Direct link to 4.1 Image Processing Workflow">â€‹</a></h3>
<p>Handles image uploads and prepares them for AI model consumption.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token decorator annotation punctuation" style="color:#393A34">@workflow</span><span class="token decorator annotation punctuation" style="color:#393A34">.</span><span class="token decorator annotation punctuation" style="color:#393A34">defn</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">ImageProcessingWorkflow</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@workflow</span><span class="token decorator annotation punctuation" style="color:#393A34">.</span><span class="token decorator annotation punctuation" style="color:#393A34">run</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> params</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ImageProcessingParams</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> ImageProcessingResult</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># Process image and return result</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="42-semantic-cache-workflow">4.2 Semantic Cache Workflow<a href="#42-semantic-cache-workflow" class="hash-link" aria-label="Direct link to 4.2 Semantic Cache Workflow" title="Direct link to 4.2 Semantic Cache Workflow">â€‹</a></h3>
<p>Checks if a semantically similar query exists in the cache.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token decorator annotation punctuation" style="color:#393A34">@workflow</span><span class="token decorator annotation punctuation" style="color:#393A34">.</span><span class="token decorator annotation punctuation" style="color:#393A34">defn</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">SemanticCacheCheckWorkflow</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@workflow</span><span class="token decorator annotation punctuation" style="color:#393A34">.</span><span class="token decorator annotation punctuation" style="color:#393A34">run</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> params</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> SemanticCacheParams</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> Dict</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Any</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># Check cache for similar queries</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="43-memory-retrieval-workflow">4.3 Memory Retrieval Workflow<a href="#43-memory-retrieval-workflow" class="hash-link" aria-label="Direct link to 4.3 Memory Retrieval Workflow" title="Direct link to 4.3 Memory Retrieval Workflow">â€‹</a></h3>
<p>Retrieves relevant memories for the current conversation.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token decorator annotation punctuation" style="color:#393A34">@workflow</span><span class="token decorator annotation punctuation" style="color:#393A34">.</span><span class="token decorator annotation punctuation" style="color:#393A34">defn</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">MemoryRetrievalWorkflow</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@workflow</span><span class="token decorator annotation punctuation" style="color:#393A34">.</span><span class="token decorator annotation punctuation" style="color:#393A34">run</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> params</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> MemoryRetrievalParams</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> Dict</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Any</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># Retrieve relevant memories</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="44-ai-generation-workflow">4.4 AI Generation Workflow<a href="#44-ai-generation-workflow" class="hash-link" aria-label="Direct link to 4.4 AI Generation Workflow" title="Direct link to 4.4 AI Generation Workflow">â€‹</a></h3>
<p>Generates AI responses using Amazon Bedrock.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token decorator annotation punctuation" style="color:#393A34">@workflow</span><span class="token decorator annotation punctuation" style="color:#393A34">.</span><span class="token decorator annotation punctuation" style="color:#393A34">defn</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">AIGenerationWorkflow</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@workflow</span><span class="token decorator annotation punctuation" style="color:#393A34">.</span><span class="token decorator annotation punctuation" style="color:#393A34">run</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> params</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> AIGenerationParams</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> Any</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># Generate AI response using Bedrock</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="45-data-ingestion-workflow">4.5 Data Ingestion Workflow<a href="#45-data-ingestion-workflow" class="hash-link" aria-label="Direct link to 4.5 Data Ingestion Workflow" title="Direct link to 4.5 Data Ingestion Workflow">â€‹</a></h3>
<p>Processes and stores documents in the vector database.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token decorator annotation punctuation" style="color:#393A34">@workflow</span><span class="token decorator annotation punctuation" style="color:#393A34">.</span><span class="token decorator annotation punctuation" style="color:#393A34">defn</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">DataIngestionWorkflow</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@workflow</span><span class="token decorator annotation punctuation" style="color:#393A34">.</span><span class="token decorator annotation punctuation" style="color:#393A34">run</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> params</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> DataIngestionParams</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> Dict</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Any</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># Process and store documents</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="5-mcp-model-context-protocol">5. MCP (Model Context Protocol)<a href="#5-mcp-model-context-protocol" class="hash-link" aria-label="Direct link to 5. MCP (Model Context Protocol)" title="Direct link to 5. MCP (Model Context Protocol)">â€‹</a></h2>
<p>The system uses a Model Context Protocol implementation for tool integration with the AI model. Key features:</p>
<ul>
<li>Tool registration and discovery</li>
<li>Tool execution with error handling</li>
<li>Prompt template management</li>
<li>Resource access</li>
</ul>
<p><strong>Available Tools:</strong></p>
<ul>
<li><code>hybrid_search</code>: Vector-based document search</li>
<li><code>store_memory</code>: Store conversation messages</li>
<li><code>retrieve_memory</code>: Get relevant conversation context</li>
<li><code>semantic_cache_response</code>: Cache AI responses</li>
<li><code>check_semantic_cache</code>: Check for cached responses</li>
<li><code>search_web</code>: Web search using Tavily API</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="6-mongodb-integration">6. MongoDB Integration<a href="#6-mongodb-integration" class="hash-link" aria-label="Direct link to 6. MongoDB Integration" title="Direct link to 6. MongoDB Integration">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="61-collections-and-indexes">6.1 Collections and Indexes<a href="#61-collections-and-indexes" class="hash-link" aria-label="Direct link to 6.1 Collections and Indexes" title="Direct link to 6.1 Collections and Indexes">â€‹</a></h3>
<p>The system uses several MongoDB collections:</p>
<ul>
<li><strong>documents</strong>: Stores processed documents with vector embeddings</li>
<li><strong>conversations</strong>: Stores conversation messages with timestamps</li>
<li><strong>memory_nodes</strong>: Stores hierarchical memory nodes</li>
<li><strong>cache</strong>: Stores semantic cache entries</li>
<li><strong>logs</strong>: Stores application logs</li>
</ul>
<p>Vector search indexes are created for similarity-based queries.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="62-vector-search">6.2 Vector Search<a href="#62-vector-search" class="hash-link" aria-label="Direct link to 6.2 Vector Search" title="Direct link to 6.2 Vector Search">â€‹</a></h3>
<p>The system uses MongoDB Atlas Vector Search for similarity queries with indexes on:</p>
<ul>
<li>Document embeddings</li>
<li>Memory embeddings</li>
<li>Conversation embeddings</li>
<li>Cache entry embeddings</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="7-installation--deployment">7. Installation &amp; Deployment<a href="#7-installation--deployment" class="hash-link" aria-label="Direct link to 7. Installation &amp; Deployment" title="Direct link to 7. Installation &amp; Deployment">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="71-environment-setup">7.1 Environment Setup<a href="#71-environment-setup" class="hash-link" aria-label="Direct link to 7.1 Environment Setup" title="Direct link to 7.1 Environment Setup">â€‹</a></h3>
<p>The system requires:</p>
<ul>
<li>MongoDB Atlas cluster</li>
<li>AWS credentials for Bedrock access</li>
<li>Docker and Docker Compose</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="72-configuration-files">7.2 Configuration Files<a href="#72-configuration-files" class="hash-link" aria-label="Direct link to 7.2 Configuration Files" title="Direct link to 7.2 Configuration Files">â€‹</a></h3>
<p>Each service has its own <code>.env</code> file for configuration:</p>
<ul>
<li><strong>MongoDB Configuration</strong>:<!-- -->
<ul>
<li><code>MONGODB_URI</code>: Connection string</li>
<li><code>DB_NAME</code>: Database name</li>
</ul>
</li>
<li><strong>AWS Configuration</strong>:<!-- -->
<ul>
<li><code>AWS_REGION</code>: AWS region</li>
<li><code>AWS_ACCESS_KEY_ID</code>: Access key</li>
<li><code>AWS_SECRET_ACCESS_KEY</code>: Secret key</li>
<li><code>EMBEDDING_MODEL_ID</code>: Model for embeddings</li>
<li><code>LLM_MODEL_ID</code>: Model for text generation</li>
</ul>
</li>
<li><strong>Service Configuration</strong>:<!-- -->
<ul>
<li><code>SERVICE_HOST</code>: Host address</li>
<li><code>SERVICE_PORT</code>: Port number</li>
<li><code>LOGGER_SERVICE_URL</code>: URL for logging service</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="73-deployment-scripts">7.3 Deployment Scripts<a href="#73-deployment-scripts" class="hash-link" aria-label="Direct link to 7.3 Deployment Scripts" title="Direct link to 7.3 Deployment Scripts">â€‹</a></h3>
<p>The system provides several scripts for deployment:</p>
<ul>
<li><code>build-push-images-to-ecr.ksh</code>: Build and push container images to Amazon ECR</li>
<li><code>mongodb_cluster_manager.ksh</code>: Manage MongoDB Atlas clusters</li>
<li><code>one-click.ksh</code>: One-click deployment using CloudFormation</li>
<li><code>build-images.ksh</code>: Build Docker images locally</li>
<li><code>docker-compose.yml</code>: Docker Compose configuration</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a href="#prerequisites" class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites">â€‹</a></h3>
<ul>
<li>AWS account with appropriate permissions</li>
<li>MongoDB Atlas account with appropriate permissions</li>
<li>Python 3.10+</li>
<li>Docker and Docker Compose installed</li>
<li>AWS CLI installed and configured</li>
<li>EC2 quota for <code>t3.xlarge</code></li>
<li>Programmatic access to your MongoDB Atlas project</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="mongodb-atlas-programmatic-access">MongoDB Atlas Programmatic Access<a href="#mongodb-atlas-programmatic-access" class="hash-link" aria-label="Direct link to MongoDB Atlas Programmatic Access" title="Direct link to MongoDB Atlas Programmatic Access">â€‹</a></h3>
<p>To enable programmatic access to your MongoDB Atlas project, follow these steps to create and manage API keys securely:</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-create-an-api-key"><strong>1. Create an API Key</strong><a href="#1-create-an-api-key" class="hash-link" aria-label="Direct link to 1-create-an-api-key" title="Direct link to 1-create-an-api-key">â€‹</a></h4>
<ol>
<li><strong>Navigate to Project Access Manager:</strong>
<ul>
<li>In the Atlas UI, select your organization and project.</li>
<li>Go to <strong>Project Access</strong> under the <strong>Access Manager</strong> menu.</li>
</ul>
</li>
<li><strong>Create API Key:</strong>
<ul>
<li>Click on the <strong>Applications</strong> tab.</li>
<li>Select <strong>API Keys</strong>.</li>
<li>Click <strong>Create API Key</strong>.</li>
<li>Provide a description for the key.</li>
<li>Assign appropriate project permissions by selecting roles that align with the principle of least privilege.</li>
<li>Click <strong>Next</strong>.</li>
</ul>
</li>
<li><strong>Save API Key Credentials:</strong>
<ul>
<li>Copy and securely store the <strong>Public Key</strong> (username) and <strong>Private Key</strong> (password).</li>
<li><strong>Important:</strong> The private key is displayed only once; ensure it&#x27;s stored securely.</li>
</ul>
</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-configure-api-access-list"><strong>2. Configure API Access List</strong><a href="#2-configure-api-access-list" class="hash-link" aria-label="Direct link to 2-configure-api-access-list" title="Direct link to 2-configure-api-access-list">â€‹</a></h4>
<ol>
<li><strong>Add Access List Entry:</strong>
<ul>
<li>After creating the API key, add an IP address or CIDR block to the API access list to specify allowed sources for API requests.</li>
<li>Click <strong>Add Access List Entry</strong>.</li>
<li>Enter the IP address or click <strong>Use Current IP Address</strong> if accessing from the current host.</li>
<li>Click <strong>Save</strong>.</li>
</ul>
</li>
<li><strong>Manage Access List:</strong>
<ul>
<li>To modify the access list, navigate to the <strong>API Keys</strong> section.</li>
<li>Click the ellipsis (<strong>...</strong>) next to the API key and select <strong>Edit Permissions</strong>.</li>
<li>Update the access list as needed.</li>
</ul>
</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="3-secure-api-key-usage"><strong>3. Secure API Key Usage</strong><a href="#3-secure-api-key-usage" class="hash-link" aria-label="Direct link to 3-secure-api-key-usage" title="Direct link to 3-secure-api-key-usage">â€‹</a></h4>
<ul>
<li><strong>Environment Variables:</strong> Store API keys in environment variables to prevent hardcoding them in your application&#x27;s source code.</li>
<li><strong>Access Controls:</strong> Limit API key permissions to the minimum required for your application&#x27;s functionality.</li>
<li><strong>Regular Rotation:</strong> Periodically rotate API keys and update your applications to use the new keys to enhance security.</li>
<li><strong>Audit Logging:</strong> Monitor API key usage through Atlas&#x27;s auditing features to detect any unauthorized access.</li>
</ul>
<p>By following these steps, you can securely grant programmatic access to your MongoDB Atlas project, ensuring that your API keys are managed and utilized in accordance with best practices.
For more detailed information, refer to <a href="https://www.mongodb.com/docs/atlas/configure-api-access/#grant-programmatic-access-to-a-project" target="_blank" rel="noopener noreferrer">Guide</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="minimum-system-requirements">Minimum System Requirements<a href="#minimum-system-requirements" class="hash-link" aria-label="Direct link to Minimum System Requirements" title="Direct link to Minimum System Requirements">â€‹</a></h3>
<ul>
<li>Sufficient CPU and memory for running Docker containers</li>
<li>Adequate network bandwidth for data transfer and API calls</li>
<li>For EC2: At least a <code>t3.medium</code> instance (or higher, depending on workload)</li>
<li>Sufficient EBS storage for EC2 instance (at least 100 GB recommended)</li>
<li>MongoDB Atlas M10 Cluster (auto-deployed by the <code>one-click</code> script)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="one-click-deployment">One-Click Deployment<a href="#one-click-deployment" class="hash-link" aria-label="Direct link to One-Click Deployment" title="Direct link to One-Click Deployment">â€‹</a></h3>
<p>The <code>one-click.ksh</code> Korn shell script automates the deployment of the MongoDB - Temporal Quickstart application on AWS infrastructure. It sets up the necessary AWS resources, deploys an EC2 instance, and configures the application environment.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites-1">Prerequisites<a href="#prerequisites-1" class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites">â€‹</a></h4>
<ul>
<li>AWS CLI installed and configured with appropriate credentials</li>
<li>Access to a MongoDB Atlas account with necessary permissions</li>
<li>Korn shell (ksh) environment</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="script-structure">Script Structure<a href="#script-structure" class="hash-link" aria-label="Direct link to Script Structure" title="Direct link to Script Structure">â€‹</a></h4>
<p>The script is organized into several main functions:</p>
<ol>
<li><code>create_key()</code>: Creates or uses an existing EC2 key pair</li>
<li><code>deploy_infra()</code>: Deploys the base infrastructure using CloudFormation</li>
<li><code>deploy_ec2()</code>: Deploys the EC2 instance and application stack</li>
<li><code>read_logs()</code>: Streams deployment logs from the EC2 instance</li>
<li>Main execution flow</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="configuration">Configuration<a href="#configuration" class="hash-link" aria-label="Direct link to Configuration" title="Direct link to Configuration">â€‹</a></h4>
<p><strong>Environment Variables</strong></p>
<ul>
<li><code>AWS_ACCESS_KEY_ID</code>: AWS access key</li>
<li><code>AWS_SECRET_ACCESS_KEY</code>: AWS secret key</li>
<li><code>AWS_SESSION_TOKEN</code>: AWS session token (if using temporary credentials)</li>
</ul>
<p><strong>Deployment Parameters</strong></p>
<ul>
<li><code>INFRA_STACK_NAME</code>: Name for the infrastructure CloudFormation stack</li>
<li><code>EC2_STACK_NAME</code>: Name for the EC2 CloudFormation stack</li>
<li><code>AWS_REGION</code>: AWS region for deployment</li>
<li><code>EC2_INSTANCE_TYPE</code>: EC2 instance type (e.g., &quot;t3.xlarge&quot;)</li>
<li><code>VolumeSize</code>: EBS volume size in GB</li>
<li><code>GIT_REPO_URL</code>: URL of the application Git repository</li>
<li><code>MongoDBClusterName</code>: Name for the MongoDB Atlas cluster</li>
<li><code>MongoDBUserName</code>: MongoDB Atlas username</li>
<li><code>MongoDBPassword</code>: MongoDB Atlas password</li>
<li><code>APIPUBLICKEY</code>: MongoDB Atlas API public key</li>
<li><code>APIPRIVATEKEY</code>: MongoDB Atlas API private key</li>
<li><code>GROUPID</code>: MongoDB Atlas project ID</li>
<li><code>TAVILY_API_KEY</code>: Tavily Web Search API Key</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="execution-flow">Execution Flow<a href="#execution-flow" class="hash-link" aria-label="Direct link to Execution Flow" title="Direct link to Execution Flow">â€‹</a></h4>
<ol>
<li>Initialize logging</li>
<li>Create or use existing EC2 key pair</li>
<li>Deploy infrastructure CloudFormation stack</li>
<li>Retrieve and store infrastructure stack outputs</li>
<li>Deploy EC2 instance and application CloudFormation stack</li>
<li>Start streaming EC2 deployment logs</li>
<li>Monitor application URL until it becomes available</li>
<li>Launch application URL in default browser</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="functions">Functions<a href="#functions" class="hash-link" aria-label="Direct link to Functions" title="Direct link to Functions">â€‹</a></h4>
<p><strong>create_key()</strong>
Creates a new EC2 key pair or uses an existing one with the name &quot;MAAPTemporalKeyV1&quot;.</p>
<p><strong>deploy_infra()</strong>
Deploys the base infrastructure CloudFormation stack, including VPC, subnet, security group, and IAM roles.</p>
<p><strong>deploy_ec2()</strong>
Deploys the EC2 instance and application stack using a CloudFormation template. It includes the following steps:</p>
<ul>
<li>Selects the appropriate AMI ID based on the AWS region</li>
<li>Creates the CloudFormation stack with necessary parameters</li>
<li>Waits for stack creation to complete</li>
<li>Retrieves and displays stack outputs</li>
</ul>
<p><strong>read_logs()</strong>
Establishes an SSH connection to the EC2 instance and streams the deployment logs in real-time.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="logging">Logging<a href="#logging" class="hash-link" aria-label="Direct link to Logging" title="Direct link to Logging">â€‹</a></h4>
<ul>
<li>Main deployment logs: <code>./logs/one-click-deployment.log</code></li>
<li>EC2 live logs: <code>./logs/ec2-live-logs.log</code></li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="error-handling">Error Handling<a href="#error-handling" class="hash-link" aria-label="Direct link to Error Handling" title="Direct link to Error Handling">â€‹</a></h4>
<p>The script includes basic error checking for critical operations such as CloudFormation stack deployments. If an error occurs, the script will log the error and exit.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="security-considerations">Security Considerations<a href="#security-considerations" class="hash-link" aria-label="Direct link to Security Considerations" title="Direct link to Security Considerations">â€‹</a></h4>
<ul>
<li>AWS credentials are expected to be set as environment variables</li>
<li>MongoDB Atlas credentials and API keys are passed as CloudFormation parameters</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="customization">Customization<a href="#customization" class="hash-link" aria-label="Direct link to Customization" title="Direct link to Customization">â€‹</a></h4>
<p>To customize the deployment:</p>
<ol>
<li>Modify the CloudFormation template files (<code>deploy-infra.yaml</code> and <code>deploy-ec2.yaml</code>)</li>
<li>Adjust the deployment parameters at the beginning of the script</li>
<li>Update the AMI IDs in the <code>ami_map</code> if newer AMIs are available</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting">Troubleshooting<a href="#troubleshooting" class="hash-link" aria-label="Direct link to Troubleshooting" title="Direct link to Troubleshooting">â€‹</a></h4>
<ul>
<li>Check the log files for detailed information on the deployment process</li>
<li>Ensure all required environment variables and parameters are correctly set</li>
<li>Verify AWS CLI configuration and permissions</li>
<li>Check CloudFormation stack events in the AWS Console for detailed error messages</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="limitations">Limitations<a href="#limitations" class="hash-link" aria-label="Direct link to Limitations" title="Direct link to Limitations">â€‹</a></h4>
<ul>
<li>The script is designed for a specific application stack and may require modifications for other use cases</li>
<li>It assumes a certain MongoDB Atlas and AWS account setup</li>
<li>The script does not include rollback mechanisms for partial deployments. In case of partial failures, delete the related CloudFormation stacks from AWS Console.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="deployment-steps">Deployment Steps<a href="#deployment-steps" class="hash-link" aria-label="Direct link to Deployment Steps" title="Direct link to Deployment Steps">â€‹</a></h4>
<ol>
<li>Clone the repository:<!-- -->
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">git clone &lt;repository-url&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd maap-temporal-qs</span><br></span></code></pre></div></div>
</li>
<li>Configure the <code>one-click.ksh</code> script:
Open the script in a text editor and fill in the required values for various environment variables:<!-- -->
<ul>
<li>AWS Auth: Specify the <code>AWS_REGION</code>, <code>AWS_ACCESS_KEY_ID</code>, <code>AWS_SECRET_ACCESS_KEY</code> for deployment.</li>
<li>EC2 Instance Types: Choose suitable instance types for your workload.</li>
<li>Network Configuration: Update key names, subnet IDs, security group IDs, etc.</li>
<li>Authentication Keys: Fetch Project ID, API public and private keys for MongoDB Atlas Cluster setup. Update the script file with the keys for <code>APIPUBLICKEY</code>, <code>APIPRIVATEKEY</code>, <code>GROUPID</code> suitably.</li>
</ul>
</li>
<li>Deploy the application:<!-- -->
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">chmod +x one-click.ksh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./one-click.ksh</span><br></span></code></pre></div></div>
</li>
<li>Access the application at <code>http://&lt;ec2-instance-ip&gt;:7860</code></li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="post-deployment-verification">Post-Deployment Verification<a href="#post-deployment-verification" class="hash-link" aria-label="Direct link to Post-Deployment Verification" title="Direct link to Post-Deployment Verification">â€‹</a></h4>
<ol>
<li>Access the UI service by navigating to <code>http://&lt;ec2-instance-ip&gt;:7860</code> in your web browser.</li>
<li>Test the system by entering a query and verifying that you receive an appropriate AI-generated response.</li>
<li>Try uploading a file to ensure the Loader Service is functioning correctly.</li>
<li>Verify that the sample dataset bundled with the script is loaded into your MongoDB Cluster name <code>MongoDBTemporalV1</code> under the database <code>travel_agency</code> and collection <code>trip_recommendation</code> by visiting the <a href="https://cloud.mongodb.com" target="_blank" rel="noopener noreferrer">MongoDB Atlas Console</a>.</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="manual-deployment">Manual Deployment<a href="#manual-deployment" class="hash-link" aria-label="Direct link to Manual Deployment" title="Direct link to Manual Deployment">â€‹</a></h3>
<p>For manual deployment, follow these steps:</p>
<ol>
<li><strong>Set up MongoDB Atlas Cluster</strong>:<!-- -->
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./mongodb_cluster_manager.ksh deploy &lt;cluster_name&gt; &lt;username&gt; &lt;password&gt;</span><br></span></code></pre></div></div>
</li>
<li><strong>Create Vector Indexes</strong>:<!-- -->
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./mongodb_create_vectorindex.ksh</span><br></span></code></pre></div></div>
</li>
<li><strong>Build Docker Images</strong>:<!-- -->
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd MAAP-Temporal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./build-images.ksh</span><br></span></code></pre></div></div>
</li>
<li><strong>Configure Environment Variables</strong>:<!-- -->
<ul>
<li>Copy each service&#x27;s sample.env to .env</li>
<li>Fill in the required environment variables (see Configuration section)</li>
</ul>
</li>
<li><strong>Deploy with Docker Compose</strong>:<!-- -->
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker-compose up -d</span><br></span></code></pre></div></div>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="8-api-reference">8. API Reference<a href="#8-api-reference" class="hash-link" aria-label="Direct link to 8. API Reference" title="Direct link to 8. API Reference">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="fastapi-application">FastAPI Application<a href="#fastapi-application" class="hash-link" aria-label="Direct link to FastAPI Application" title="Direct link to FastAPI Application">â€‹</a></h3>
<ul>
<li><code>POST /upload</code>: Upload files and web URLs for processing</li>
<li><code>POST /log</code>: Log messages to the centralized logging system</li>
<li><code>GET /health</code>: Health check endpoint</li>
<li><code>POST /conversation/</code>: Add a message to the conversation history</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="mcp-server">MCP Server<a href="#mcp-server" class="hash-link" aria-label="Direct link to MCP Server" title="Direct link to MCP Server">â€‹</a></h3>
<ul>
<li><code>/hybrid_search</code>: Perform hybrid vector and keyword search on MongoDB collections</li>
<li><code>/store_memory</code>: Store conversation messages in AI memory</li>
<li><code>/retrieve_memory</code>: Retrieve relevant memories for context</li>
<li><code>/semantic_cache_response</code>: Cache AI responses for similar future queries</li>
<li><code>/check_semantic_cache</code>: Check for cached responses to similar queries</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="semantic-cache-service">Semantic Cache Service<a href="#semantic-cache-service" class="hash-link" aria-label="Direct link to Semantic Cache Service" title="Direct link to Semantic Cache Service">â€‹</a></h3>
<ul>
<li><code>POST /save_to_cache</code>: Save a query-response pair to the cache</li>
<li><code>POST /read_cache</code>: Lookup a query in the semantic cache</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="data-loader-service">Data Loader Service<a href="#data-loader-service" class="hash-link" aria-label="Direct link to Data Loader Service" title="Direct link to Data Loader Service">â€‹</a></h3>
<ul>
<li><code>POST /upload</code>: Upload and process files or web URLs</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="event-logger-service">Event Logger Service<a href="#event-logger-service" class="hash-link" aria-label="Direct link to Event Logger Service" title="Direct link to Event Logger Service">â€‹</a></h3>
<ul>
<li><code>POST /log</code>: Log a message</li>
<li><code>GET /status</code>: Get logger status</li>
<li><code>POST /force-flush</code>: Manually flush log buffer</li>
</ul>
<p>For detailed API documentation, access the Swagger UI at <code>http://&lt;component-host&gt;:&lt;port&gt;/docs</code>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="9-usage-flow">9. Usage Flow<a href="#9-usage-flow" class="hash-link" aria-label="Direct link to 9. Usage Flow" title="Direct link to 9. Usage Flow">â€‹</a></h2>
<ol>
<li>
<p><strong>Document Ingestion</strong>:</p>
<ul>
<li>User uploads files or provides URLs</li>
<li>Documents are processed and embedded</li>
<li>Vector database is populated</li>
</ul>
</li>
<li>
<p><strong>User Query</strong>:</p>
<ul>
<li>User submits a query via UI</li>
<li>System checks semantic cache for similar queries</li>
<li>If no cache hit, system retrieves relevant memories and context</li>
<li>AI generates a response using relevant context</li>
<li>Response is stored in memory and cache</li>
</ul>
</li>
<li>
<p><strong>Memory Usage</strong>:</p>
<ul>
<li>System maintains a hierarchical memory structure</li>
<li>Memories are reinforced or decay based on access patterns</li>
<li>Important memories are preserved longer</li>
<li>Similar memories are consolidated</li>
</ul>
</li>
<li>
<p><strong>Access the web interface</strong>:</p>
<ul>
<li>Enter a user ID to associate with your session</li>
<li>Select the desired preprocessing workflows (semantic cache, AI memory, etc.)</li>
<li>Type queries or upload files to interact with the AI system</li>
<li>Use special commands:<!-- -->
<ul>
<li>&quot;refresh&quot; to start a new conversation</li>
<li>&quot;image:/path/to/image.jpg Your query&quot; to include images in your query</li>
</ul>
</li>
</ul>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="10-error-handling-and-logging">10. Error Handling and Logging<a href="#10-error-handling-and-logging" class="hash-link" aria-label="Direct link to 10. Error Handling and Logging" title="Direct link to 10. Error Handling and Logging">â€‹</a></h2>
<p>The system features:</p>
<ul>
<li>Centralized logging through the Event Logger service</li>
<li>Structured logs with context information</li>
<li>Local and remote log storage</li>
<li>Error tracking and reporting</li>
<li>Graceful failure handling through Temporal</li>
</ul>
<p>Common issues and solutions:</p>
<ol>
<li>
<p>Connection errors:</p>
<ul>
<li>Check MongoDB and AWS credentials in the configuration</li>
<li>Verify network connectivity and service URLs in configuration</li>
<li>Check security groups and firewall settings</li>
</ul>
</li>
<li>
<p>Workflow failures:</p>
<ul>
<li>Review Temporal logs and ensure all required services are running</li>
<li>Check workflow history in Temporal Web UI</li>
<li>Verify all activities are properly registered</li>
</ul>
</li>
<li>
<p>Image processing errors:</p>
<ul>
<li>Verify supported image formats and file permissions</li>
<li>Check for sufficient disk space</li>
<li>Ensure proper libraries are installed</li>
</ul>
</li>
<li>
<p>Slow response times:</p>
<ul>
<li>Check semantic cache performance and consider adjusting similarity thresholds</li>
<li>Monitor MongoDB performance and indexes</li>
<li>Review AWS Bedrock service quotas</li>
</ul>
</li>
<li>
<p>Authentication failures:</p>
<ul>
<li>Verify AWS and MongoDB credentials</li>
<li>Check IAM roles and permissions</li>
</ul>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="11-security-considerations">11. Security Considerations<a href="#11-security-considerations" class="hash-link" aria-label="Direct link to 11. Security Considerations" title="Direct link to 11. Security Considerations">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="network-and-firewall-configuration">Network and Firewall Configuration<a href="#network-and-firewall-configuration" class="hash-link" aria-label="Direct link to Network and Firewall Configuration" title="Direct link to Network and Firewall Configuration">â€‹</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="mongodb-atlas"><strong>MongoDB Atlas:</strong><a href="#mongodb-atlas" class="hash-link" aria-label="Direct link to mongodb-atlas" title="Direct link to mongodb-atlas">â€‹</a></h4>
<ul>
<li>
<p><strong>IP Access List:</strong></p>
<ul>
<li>Restrict client connections to your Atlas clusters by configuring IP access lists.</li>
<li>Add the public IP addresses of your application environments to the IP access list to permit access.</li>
<li>For enhanced security, consider using VPC peering or private endpoints to allow private IP addresses.</li>
<li><a href="https://www.mongodb.com/docs/atlas/security/ip-access-list/" target="_blank" rel="noopener noreferrer">Configure IP Access List Entries</a>.</li>
</ul>
</li>
<li>
<p><strong>Ports 27015 to 27017 (TCP):</strong></p>
<ul>
<li>Ensure that your firewall allows outbound connections from your application environment to Atlas on ports <strong>27015 to 27017</strong> for TCP traffic.</li>
<li>This configuration enables your applications to access databases hosted on Atlas.</li>
</ul>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="aws-services-eg-bedrock"><strong>AWS Services (e.g., Bedrock):</strong><a href="#aws-services-eg-bedrock" class="hash-link" aria-label="Direct link to aws-services-eg-bedrock" title="Direct link to aws-services-eg-bedrock">â€‹</a></h4>
<ul>
<li><strong>Port 443 (HTTPS):</strong>
<ul>
<li>Required for API calls and interactions.</li>
<li>Configure security groups to allow outbound traffic on port 443.</li>
<li>Ensure Network ACLs permit inbound and outbound traffic on this port.</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="authentication-and-authorization">Authentication and Authorization<a href="#authentication-and-authorization" class="hash-link" aria-label="Direct link to Authentication and Authorization" title="Direct link to Authentication and Authorization">â€‹</a></h3>
<ul>
<li>
<p><strong>Database Users:</strong></p>
<ul>
<li>Atlas mandates client authentication to access clusters.</li>
<li>Create database users with appropriate roles to control access.</li>
<li><a href="https://www.mongodb.com/docs/atlas/security/config-db-auth/" target="_blank" rel="noopener noreferrer">Configure Database Users</a>.</li>
</ul>
</li>
<li>
<p><strong>Custom Roles:</strong></p>
<ul>
<li>If default roles don&#x27;t meet your requirements, define custom roles with specific privileges.</li>
<li><a href="https://www.mongodb.com/docs/atlas/security/config-db-auth/#custom-database-roles" target="_blank" rel="noopener noreferrer">Create Custom Roles</a>.</li>
</ul>
</li>
<li>
<p><strong>AWS IAM Integration:</strong></p>
<ul>
<li>Authenticate applications running on AWS services to Atlas clusters using AWS IAM roles.</li>
<li>Set up database users to use AWS IAM role ARNs for authentication.</li>
<li><a href="https://www.mongodb.com/docs/atlas/security/config-db-auth/#authentication-with-aws-iam" target="_blank" rel="noopener noreferrer">AWS IAM Authentication</a>.</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="data-encryption">Data Encryption<a href="#data-encryption" class="hash-link" aria-label="Direct link to Data Encryption" title="Direct link to Data Encryption">â€‹</a></h3>
<ul>
<li>
<p><strong>Encryption at Rest:</strong></p>
<ul>
<li>Atlas encrypts all data stored on your clusters by default.</li>
<li>For enhanced security, consider using your own key management system.</li>
<li><a href="https://www.mongodb.com/docs/atlas/security/encryption-at-rest/" target="_blank" rel="noopener noreferrer">Encryption at Rest</a>.</li>
</ul>
</li>
<li>
<p><strong>TLS/SSL Encryption:</strong></p>
<ul>
<li>Atlas requires TLS encryption for client connections and intra-cluster communications.</li>
<li>Ensure your applications support TLS 1.2 or higher.</li>
<li><a href="https://www.mongodb.com/docs/atlas/security/tls-ssl/" target="_blank" rel="noopener noreferrer">TLS/SSL Configuration</a>.</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="network-peering-and-private-endpoints">Network Peering and Private Endpoints<a href="#network-peering-and-private-endpoints" class="hash-link" aria-label="Direct link to Network Peering and Private Endpoints" title="Direct link to Network Peering and Private Endpoints">â€‹</a></h3>
<ul>
<li>
<p><strong>VPC Peering:</strong></p>
<ul>
<li>Establish VPC peering between your AWS VPC and MongoDB Atlas&#x27;s VPC to eliminate public internet exposure.</li>
<li><a href="https://www.mongodb.com/docs/atlas/security/vpc-peering/" target="_blank" rel="noopener noreferrer">Set Up a Network Peering Connection</a>.</li>
</ul>
</li>
<li>
<p><strong>Private Endpoints:</strong></p>
<ul>
<li>Use AWS PrivateLink to create private endpoints for secure communication within AWS networks.</li>
<li><a href="https://www.mongodb.com/docs/atlas/security-cluster-private-endpoint/" target="_blank" rel="noopener noreferrer">Configure Private Endpoints</a>.</li>
</ul>
</li>
<li>
<p><strong>NAT Gateway:</strong></p>
<ul>
<li>Use NAT Gateways to route traffic from private subnets while preventing direct internet access to EC2 instances.</li>
</ul>
</li>
<li>
<p><strong>Specific IP Ranges:</strong></p>
<ul>
<li>AWS services like Bedrock use dynamic IPs. Filter these from <a href="https://ip-ranges.amazonaws.com/ip-ranges.json" target="_blank" rel="noopener noreferrer">AWS IP Ranges</a> for egress traffic.</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="compliance-and-monitoring">Compliance and Monitoring<a href="#compliance-and-monitoring" class="hash-link" aria-label="Direct link to Compliance and Monitoring" title="Direct link to Compliance and Monitoring">â€‹</a></h3>
<ul>
<li>
<p><strong>Audit Logging:</strong></p>
<ul>
<li>Enable audit logging to monitor database activities and ensure compliance with data protection regulations.</li>
<li><a href="https://www.mongodb.com/docs/atlas/security/audit-logging/" target="_blank" rel="noopener noreferrer">Enable Audit Logging</a>.</li>
</ul>
</li>
<li>
<p><strong>Regular Updates:</strong></p>
<ul>
<li>Keep your dependencies and Docker images up to date to address security vulnerabilities.</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="12-monitoring--logging">12. Monitoring &amp; Logging<a href="#12-monitoring--logging" class="hash-link" aria-label="Direct link to 12. Monitoring &amp; Logging" title="Direct link to 12. Monitoring &amp; Logging">â€‹</a></h2>
<p>The MAAP system includes a comprehensive logging solution:</p>
<ol>
<li>
<p><strong>Centralized Logging</strong>:</p>
<ul>
<li>All services log to the Logger Service</li>
<li>Logs are stored in both files and MongoDB</li>
</ul>
</li>
<li>
<p><strong>Log Levels</strong>:</p>
<ul>
<li>DEBUG: Detailed debugging information</li>
<li>INFO: General operational information</li>
<li>WARNING: Warning events</li>
<li>ERROR: Error events</li>
<li>CRITICAL: Critical events</li>
</ul>
</li>
<li>
<p><strong>Log Retention</strong>:</p>
<ul>
<li>File logs are rotated daily and retained for 10 days</li>
<li>MongoDB logs have a TTL index for automatic cleanup</li>
</ul>
</li>
<li>
<p><strong>Monitoring</strong>:</p>
<ul>
<li>Service health can be monitored via the Logger Service</li>
<li>MongoDB Atlas provides monitoring for database operations</li>
</ul>
</li>
</ol>
<p>To access logs:</p>
<ul>
<li>View log files in the <code>logs</code> directory of each service</li>
<li>Query the <code>event_logs.logs</code> collection in MongoDB</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="13-troubleshooting">13. Troubleshooting<a href="#13-troubleshooting" class="hash-link" aria-label="Direct link to 13. Troubleshooting" title="Direct link to 13. Troubleshooting">â€‹</a></h2>
<p>Common issues and solutions:</p>
<ol>
<li>
<p><strong>Connection Issues</strong>:</p>
<ul>
<li><strong>Problem</strong>: Services cannot connect to MongoDB</li>
<li><strong>Solution</strong>: Verify MongoDB URI, network connectivity, and whitelist IP addresses</li>
</ul>
</li>
<li>
<p><strong>Vector Index Errors</strong>:</p>
<ul>
<li><strong>Problem</strong>: Vector search fails</li>
<li><strong>Solution</strong>: Run <code>mongodb_create_vectorindex.ksh</code> to recreate indexes</li>
</ul>
</li>
<li>
<p><strong>AWS Bedrock Access</strong>:</p>
<ul>
<li><strong>Problem</strong>: Cannot access AWS Bedrock models</li>
<li><strong>Solution</strong>: Check AWS credentials and region configuration</li>
</ul>
</li>
<li>
<p><strong>Docker Compose Issues</strong>:</p>
<ul>
<li><strong>Problem</strong>: Services fail to start</li>
<li><strong>Solution</strong>: Check logs with <code>docker-compose logs</code> and ensure environment variables are set</li>
</ul>
</li>
<li>
<p><strong>Memory Issues</strong>:</p>
<ul>
<li><strong>Problem</strong>: Services crash with out-of-memory errors</li>
<li><strong>Solution</strong>: Increase container memory limits in docker-compose.yml</li>
</ul>
</li>
<li>
<p><strong>Slow Response Times</strong>:</p>
<ul>
<li><strong>Problem</strong>: System responses are slow</li>
<li><strong>Solution</strong>: Increase service replicas, check MongoDB performance, optimize vector indexes</li>
</ul>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="14-scalability-considerations">14. Scalability Considerations<a href="#14-scalability-considerations" class="hash-link" aria-label="Direct link to 14. Scalability Considerations" title="Direct link to 14. Scalability Considerations">â€‹</a></h2>
<p>The system is designed for scalability:</p>
<ul>
<li>Microservices architecture allows independent scaling</li>
<li>Temporal provides reliable workflow execution at scale</li>
<li>MongoDB Atlas supports horizontal scaling</li>
<li>Container-based deployment enables orchestration systems like Kubernetes</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="15-development-guide">15. Development Guide<a href="#15-development-guide" class="hash-link" aria-label="Direct link to 15. Development Guide" title="Direct link to 15. Development Guide">â€‹</a></h2>
<p>To contribute to the project:</p>
<ol>
<li>Set up a local development environment with Python 3.10+</li>
<li>Use virtual environments for dependency management</li>
<li>Follow Python best practices and PEP 8 style guidelines</li>
<li>Implement unit tests for all components</li>
<li>Use type hints and docstrings for better code readability and documentation</li>
<li>Submit pull requests for code reviews before merging changes</li>
</ol>
<p>To extend the system:</p>
<ol>
<li>Add new workflows in <code>workflows.py</code></li>
<li>Implement new activities in <code>activities.py</code></li>
<li>Extend the MCP server with new tools in <code>maap_mcp_server.py</code></li>
<li>Update the UI in <code>ui_app.py</code> to expose new functionalities</li>
<li>Follow existing patterns for error handling and logging</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="16-maintenance--operations">16. Maintenance &amp; Operations<a href="#16-maintenance--operations" class="hash-link" aria-label="Direct link to 16. Maintenance &amp; Operations" title="Direct link to 16. Maintenance &amp; Operations">â€‹</a></h2>
<ul>
<li>Health check endpoints on all services</li>
<li>Workflow status monitoring via Temporal UI</li>
<li>Log analysis for error detection</li>
<li>MongoDB performance monitoring</li>
<li>Regularly backup MongoDB data and ensure proper retention policies</li>
<li>Monitor and optimize MongoDB indexes for performance</li>
<li>Keep Temporal workflows and activities up to date with the latest business logic</li>
<li>Regularly review and update AI models and embeddings for improved performance</li>
<li>Monitor AWS Bedrock usage and costs, adjusting as necessary</li>
<li>Implement a log rotation policy to manage disk space usage</li>
<li>Monitor system resource usage and scale as needed</li>
<li>Implement automated alerts for critical errors or system issues</li>
<li>Keep all dependencies and services up-to-date with the latest stable versions</li>
<li>Regularly review and optimize performance bottlenecks</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">â€‹</a></h2>
<p>MongoDB - Temporal Quickstart provides a robust, scalable architecture for AI applications with advanced memory, caching, and document processing capabilities. By leveraging MongoDB Atlas for vector storage, Amazon Bedrock for AI, and Temporal for workflow orchestration, it offers a reliable foundation for building sophisticated AI applications with workflow reliability and data persistence.</p></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/maap-framework/docs/quick-starts/quickstarts/meta"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Meta</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/maap-framework/docs/quick-starts/quickstarts/togetherai"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">TogtherAI</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#table-of-contents" class="table-of-contents__link toc-highlight">Table of Contents</a></li><li><a href="#1-system-overview" class="table-of-contents__link toc-highlight">1. System Overview</a></li><li><a href="#2-architecture" class="table-of-contents__link toc-highlight">2. Architecture</a><ul><li><a href="#21-core-components" class="table-of-contents__link toc-highlight">2.1 Core Components</a></li><li><a href="#22-integration-points" class="table-of-contents__link toc-highlight">2.2 Integration Points</a></li></ul></li><li><a href="#3-services-in-detail" class="table-of-contents__link toc-highlight">3. Services in Detail</a><ul><li><a href="#31-host-service" class="table-of-contents__link toc-highlight">3.1 Host Service</a></li><li><a href="#32-ai-memory-service" class="table-of-contents__link toc-highlight">3.2 AI Memory Service</a></li><li><a href="#33-semantic-cache-service" class="table-of-contents__link toc-highlight">3.3 Semantic Cache Service</a></li><li><a href="#34-data-loader-service" class="table-of-contents__link toc-highlight">3.4 Data Loader Service</a></li><li><a href="#35-event-logger-service" class="table-of-contents__link toc-highlight">3.5 Event Logger Service</a></li></ul></li><li><a href="#4-workflows" class="table-of-contents__link toc-highlight">4. Workflows</a><ul><li><a href="#41-image-processing-workflow" class="table-of-contents__link toc-highlight">4.1 Image Processing Workflow</a></li><li><a href="#42-semantic-cache-workflow" class="table-of-contents__link toc-highlight">4.2 Semantic Cache Workflow</a></li><li><a href="#43-memory-retrieval-workflow" class="table-of-contents__link toc-highlight">4.3 Memory Retrieval Workflow</a></li><li><a href="#44-ai-generation-workflow" class="table-of-contents__link toc-highlight">4.4 AI Generation Workflow</a></li><li><a href="#45-data-ingestion-workflow" class="table-of-contents__link toc-highlight">4.5 Data Ingestion Workflow</a></li></ul></li><li><a href="#5-mcp-model-context-protocol" class="table-of-contents__link toc-highlight">5. MCP (Model Context Protocol)</a></li><li><a href="#6-mongodb-integration" class="table-of-contents__link toc-highlight">6. MongoDB Integration</a><ul><li><a href="#61-collections-and-indexes" class="table-of-contents__link toc-highlight">6.1 Collections and Indexes</a></li><li><a href="#62-vector-search" class="table-of-contents__link toc-highlight">6.2 Vector Search</a></li></ul></li><li><a href="#7-installation--deployment" class="table-of-contents__link toc-highlight">7. Installation &amp; Deployment</a><ul><li><a href="#71-environment-setup" class="table-of-contents__link toc-highlight">7.1 Environment Setup</a></li><li><a href="#72-configuration-files" class="table-of-contents__link toc-highlight">7.2 Configuration Files</a></li><li><a href="#73-deployment-scripts" class="table-of-contents__link toc-highlight">7.3 Deployment Scripts</a></li><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li><li><a href="#mongodb-atlas-programmatic-access" class="table-of-contents__link toc-highlight">MongoDB Atlas Programmatic Access</a></li><li><a href="#minimum-system-requirements" class="table-of-contents__link toc-highlight">Minimum System Requirements</a></li><li><a href="#one-click-deployment" class="table-of-contents__link toc-highlight">One-Click Deployment</a></li><li><a href="#manual-deployment" class="table-of-contents__link toc-highlight">Manual Deployment</a></li></ul></li><li><a href="#8-api-reference" class="table-of-contents__link toc-highlight">8. API Reference</a><ul><li><a href="#fastapi-application" class="table-of-contents__link toc-highlight">FastAPI Application</a></li><li><a href="#mcp-server" class="table-of-contents__link toc-highlight">MCP Server</a></li><li><a href="#semantic-cache-service" class="table-of-contents__link toc-highlight">Semantic Cache Service</a></li><li><a href="#data-loader-service" class="table-of-contents__link toc-highlight">Data Loader Service</a></li><li><a href="#event-logger-service" class="table-of-contents__link toc-highlight">Event Logger Service</a></li></ul></li><li><a href="#9-usage-flow" class="table-of-contents__link toc-highlight">9. Usage Flow</a></li><li><a href="#10-error-handling-and-logging" class="table-of-contents__link toc-highlight">10. Error Handling and Logging</a></li><li><a href="#11-security-considerations" class="table-of-contents__link toc-highlight">11. Security Considerations</a><ul><li><a href="#network-and-firewall-configuration" class="table-of-contents__link toc-highlight">Network and Firewall Configuration</a></li><li><a href="#authentication-and-authorization" class="table-of-contents__link toc-highlight">Authentication and Authorization</a></li><li><a href="#data-encryption" class="table-of-contents__link toc-highlight">Data Encryption</a></li><li><a href="#network-peering-and-private-endpoints" class="table-of-contents__link toc-highlight">Network Peering and Private Endpoints</a></li><li><a href="#compliance-and-monitoring" class="table-of-contents__link toc-highlight">Compliance and Monitoring</a></li></ul></li><li><a href="#12-monitoring--logging" class="table-of-contents__link toc-highlight">12. Monitoring &amp; Logging</a></li><li><a href="#13-troubleshooting" class="table-of-contents__link toc-highlight">13. Troubleshooting</a></li><li><a href="#14-scalability-considerations" class="table-of-contents__link toc-highlight">14. Scalability Considerations</a></li><li><a href="#15-development-guide" class="table-of-contents__link toc-highlight">15. Development Guide</a></li><li><a href="#16-maintenance--operations" class="table-of-contents__link toc-highlight">16. Maintenance &amp; Operations</a></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Â© 2025 MongoDB, Inc.</div></div></div></footer></div>
</body>
</html>